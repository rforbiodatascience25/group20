---
title: "lab07_assignment"
format: html
editor: visual
---

## Load Libraries

```{r}
library("tidyverse")
library("broom")
library("cowplot")
```

## Load data

We will in this mini-report a biopsy dataset from the university of Wisconsin Hospitals. A set of 699 patients and a sample from nine variables with a scoring of 1-10 seen in the figure below, along with the outcome of the tumor.

```{r}
#| message: false
biopsy <- read_csv("https://wilkelab.org/classes/SDS348/data_sets/biopsy.csv")
biopsy |> glimpse(width = 5)
```

## Data Wrangle

```{r}
pca_fit <- biopsy |>
  select(where(is.numeric)) |>
  prcomp(scale = TRUE)
```

## Analysis

## PC coordinates

```{r}
pca_fit |>
  augment(biopsy) |>
  ggplot(aes(.fittedPC1, .fittedPC2, color = outcome)) + 
  geom_point(size = 1.5) +
  scale_color_manual(
    values = c(malignant = "salmon", benign = "skyblue")
  ) +
  theme_half_open(12) + background_grid() +
  labs(title = "PCA Space",
       x = "Principal component 1", 
       y = "Principal component 2",
       color = "Tumor outcome")
```
